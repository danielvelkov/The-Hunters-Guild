<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Create Hunting Quest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      type="text/css"
      media="screen"
      href="css/new-quest-post.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  </head>
  <body>
    <h1><%= title %></h1>
    <label for="monster-select">Large Monsters: </label>
    <select class="form-control" name="monster" id="monster-select">
      <option></option>
      <% if (monsters) { %> <% monsters.forEach((monster) => { %>
      <option
        value="<%= monster.id %>"
        data-elements="<%= monster.weaknesses.elements.map((ew) => `${ew.name},${ew.icon}`).join('|') %>"
        data-ailments="<%= monster.weaknesses.ailments.map((ew) => `${ew.name},${ew.icon}`).join('|') %>"
        data-monster-icon="<%= monster.icon %>"
      >
        <%= monster.name %>
        <hr />
      </option>
      <% }) %> <% } %>
    </select>
  </body>
  <script>
    $(document).ready(function () {
      $('#monster-select').select2({
        width: 'resolve',
        templateResult: function (item) {
          return $(`<span>
                <img height='18' src="icons/Large Monster Icons/${
                  item.element?.dataset.monsterIcon
                }.png"/> ${item.text} 
                <br/>
                Elem. Weak: ${item.element?.dataset.elements
                  .split('|')
                  .map((e) => {
                    const [name, icon] = e.split(',');
                    if (icon)
                      return `<img height='18' alt='${name}' title='${name}' src="icons/Status Icons/${icon}.png"' />`;
                    else return '';
                  })
                  .join('')}
                <br/>
                Status Weak: ${item.element?.dataset.ailments
                  .split('|')
                  .map((e) => {
                    const [name, icon] = e.split(',');
                    if (icon)
                      return `<img height='18' alt='${name}' title='${name}' src="icons/Status Icons/${icon}.png"' />`;
                    else return '';
                  })
                  .join('')}
            </span>`);
        },
      });
    });
  </script>
</html>
